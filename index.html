<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Статистика Текста Виджет</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 3px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }
      body {
        background-color: #ffffff;
        margin: 0;
        padding: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "react": "https://aistudiocdn.com/react@^19.2.0",
          "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.0/client"
        }
      }
    </script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
      import React, { useState, useMemo } from 'react';
      import ReactDOM from 'react-dom/client';

      const StatBox = ({ label, value }) => (
        <div className="flex flex-col items-center justify-center p-3 bg-slate-50 rounded-lg border border-slate-100 hover:border-blue-200 transition-colors">
          <span className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 text-center leading-tight">{label}</span>
          <span className="text-xl font-bold text-slate-700">{value}</span>
        </div>
      );

      const App = () => {
        const [text, setText] = useState('');

        // Stats Calculation
        const stats = useMemo(() => {
          const trimmed = text.trim();
          if (!trimmed) {
            return { characters: 0, charactersNoSpaces: 0, words: 0, sentences: 0, paragraphs: 0, readingTime: '0 с' };
          }

          const characters = text.length;
          // Remove all whitespace to count characters without spaces
          const charactersNoSpaces = text.replace(/\s/g, '').length;
          // Split by whitespace
          const words = trimmed.split(/\s+/).length;
          // Split by punctuation (. ! ?)
          const sentences = text.split(/[.!?]+/).filter(t => t.trim().length > 0).length;
          // Split by newlines
          const paragraphs = text.split(/\n+/).filter(t => t.trim().length > 0).length;
          
          const readingTimeSeconds = Math.ceil(words / (200 / 60)); // Approx 200 words per minute
          const readingTime = readingTimeSeconds > 60 
            ? `${Math.ceil(readingTimeSeconds / 60)} мин` 
            : `${readingTimeSeconds} с`;

          return { characters, charactersNoSpaces, words, sentences, paragraphs, readingTime };
        }, [text]);

        return (
          <div className="w-full max-w-3xl mx-auto p-4 bg-white text-slate-800">
            {/* Widget Header */}
            <header className="flex items-center gap-3 mb-5 border-b border-slate-100 pb-4">
               <div className="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center text-white shadow-sm">
                 <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"/><path d="M18 14h-8"/><path d="M15 18h-5"/><path d="M10 6h8"/></svg>
               </div>
               <div>
                 <h1 className="text-xl font-bold text-slate-900 leading-tight">Анализ Текста</h1>
                 <p className="text-sm text-slate-400 font-medium">Статистика символов и слов</p>
               </div>
            </header>

            {/* Input Area */}
            <div className="relative group mb-6">
              <textarea
                value={text}
                onChange={(e) => setText(e.target.value)}
                placeholder="Введите или вставьте текст для подсчета статистики..."
                className="w-full h-64 p-5 bg-slate-50 border border-slate-200 rounded-xl resize-y focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all text-base text-slate-700 placeholder:text-slate-400 leading-relaxed"
                spellCheck="true"
              />
              {text && (
                <button 
                  onClick={() => setText('')}
                  className="absolute top-3 right-3 p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                  title="Очистить"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
              )}
            </div>

            {/* Stats Bar */}
            <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-3">
              <StatBox label="Всего знаков" value={stats.characters} />
              <StatBox label="Без пробелов" value={stats.charactersNoSpaces} />
              <StatBox label="Слов" value={stats.words} />
              <StatBox label="Предложений" value={stats.sentences} />
              <StatBox label="Абзацев" value={stats.paragraphs} />
              <StatBox label="Время чтения" value={stats.readingTime} />
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>